var mssqlobj = new ypMssqlConnector('database'); // configure MsSQL from "Remote Sources tab"

//yprequest.query is used to access the request URL parameters
var qstr=yprequest.query; //provides { "cid":"1" , "popularity":"22" }

var cid=qstr.cid; //provides { "1" }
var popu=qstr.popularity; // provides { "22" }
var query="select * from tripeazzedata.cities where cid=?;";

//array of parameters needs to be used in the MsSQL query.
var parameters=[cid];

//mssqlobj.select performs select operation of the query
var res=mssqlobj.select(query,parameters);
if(res.length>0)
  {
    var query1="update tripeazzedata.cities set popularity = ? where cid=?;";
    var parameters1=[popu,cid];
    //mssqlobj.execute executes the query
    mssqlobj.execute(query1,parameters1);
    
    var query2="select * from tripeazzedata.cities where cid=?;";
    var parameters2=[cid];
    mssqlobj.select(query2,parameters2);
    ypresponse.status = 200;
    //remoteResponse holds the results obtained from the execution of MsSQL statments
    ypresponse.body= mssqlobj.remoteResponse;
    ypresponse.headers['Content-Type']="application/json";
  }
else
  {
    ypresponse.body="Invalid Company ID";
  }
